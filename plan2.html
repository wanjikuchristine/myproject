<!DOCTYPE html>

<html>
<style type="text/css" media="screen">
    #section1>div{
        position:absolute;
        margin-left:500px;
        margin-top: -75px;
    }
    #results{
        float: right;
    }
        /* Put your CSS styling here */


</style>


<script type="text/javascript">
            var reponu,charno,mapno;
    function reportload(repoid)
    {
      reponu = 0;
     $("#reports").html("");

        $.get('../api/reportTables.json',function(rep){
            $(rep.reportTables).each(function(i,rdata){
                $.get(rdata.href+".json",function(repdata){
                    $(repdata).each(function(index,data){
                        $(data.indicators).each(function(i,cdata){
                            if(repoid==cdata.id)  {
                             reponu++;
                                console.log(reponu+':'+repoid);
                            }

                        });
                    });
                });

            });
        }) ;

    }
            function chartload (charid){
                charno=0;
                $("#charts").html("");
                $.get('../api/charts.json',function(char){
                    $(char.charts).each(function(i,chdata){
                        $.get(chdata.href+".json",function(crdata){
                            $(crdata).each(function(index,data){
                                $(data.indicators).each(function(i,hdata){
                                    if(charid==hdata.id){
                                        charno++;
                                        console.log(charno+':'+charid);
                                    }
                                });
                            });
                        });
                    });
                });

            }
            function mapload (maid){
                mapno =0;
                $("#maps").html("");
                   $('../api/mapViews.json',function(mapi){
                       $(mapi.maps).each(function(i,mapdata){
                           $.get(mapdata.href+".json",function(mapidata){
                               $(mapidata).each(function(index,data){
                                   $(data.indicators).each(function(i,mdata){
                                       if(maid==mdata.id){
                                           mapno++;
                                           console.log(mapno+':'+maid);
                                       }
                                   });
                               });
                           });
                       });
                   }) ;


            }

    $(document).ready(function(){
        $("#search").keyup(function(){
            // cls
            $("#results").html("");
            $.get('../api/indicatorGroups/query/'+$(this).val()+'.json', function(json){
                $(json.indicatorGroups).each(function(i, data){
                    var anchor = $("<a></a>").attr("href",data.href).attr("id",data.name.replace(' ','_')).append(data.name);
                  // alert($(json.indicatorGroups).length);
                    $("#results").append(anchor).append("<br/>");
                    anchor.bind("click",function(e){
                        e.preventDefault();
                        $.get($(this).attr("href")+".json", function(json){
                            $(json.indicators).each(function(i, d){
                                var anchor = $("<a></a>").attr("href","#").attr("id",d.name.replace(' ','_')).append(d.name);
                                console.log($(json.indicators).length);
                                $("#section1").append(anchor).append("<br/>");
                                reportload(d.id);
                                   console.log(d.id);
                                chartload(d.id);
                                console.log(d.id);
                            });

                        });
                    });
                });
            });
        });
    });
   // $.size("#results")
   /* var sum=0
    for(var i=0;i<"#results".length;i++){
        sum=sum+i;
        document.write(sum+"<br/>");
    }    */
    </script>
<div>
    <label for="search">Search section</label>
    <input type="text" id="search" />
    <div id = "results">

    </div>
    <div id = "section1">
    </div>
</div>